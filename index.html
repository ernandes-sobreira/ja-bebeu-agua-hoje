<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Hidrata√ß√£o Di√°ria</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
:root{
  --azul-escuro:#0b3c5d;
  --azul:#1f6fa3;
  --azul-claro:#cfe9f7;
  --azul-muito-claro:#eef7fc;
  --texto:#0e2233;
}

*{box-sizing:border-box;font-family:"Segoe UI",system-ui,sans-serif}

body{
  margin:0;
  background:linear-gradient(180deg,var(--azul-muito-claro),#ffffff);
  color:var(--texto);
}

/* ---------- HEADER ---------- */
header{
  padding:1rem;
  background:var(--azul-escuro);
  color:#fff;
  text-align:center;
  font-size:1.2rem;
  font-weight:600;
}

/* ---------- LAYOUT ---------- */
.container{
  max-width:1100px;
  margin:auto;
  padding:1rem;
  display:grid;
  grid-template-columns:320px 1fr;
  gap:1.2rem;
}

.card{
  background:#fff;
  border-radius:18px;
  padding:1.2rem;
  box-shadow:0 12px 30px rgba(0,0,0,.08);
}

/* ---------- COPO ---------- */
.copo-wrapper{
  display:flex;
  flex-direction:column;
  align-items:center;
  gap:.6rem;
}

.copo{
  width:130px;
  height:240px;
  border:5px solid var(--azul-escuro);
  border-radius:0 0 25px 25px;
  position:relative;
  overflow:hidden;
  background:#fff;
}

.agua{
  position:absolute;
  bottom:0;
  width:100%;
  height:0%;
  background:linear-gradient(180deg,var(--azul),var(--azul-claro));
  transition:height .6s ease;
}

.agua::after{
  content:"";
  position:absolute;
  top:-10px;
  left:-20%;
  width:140%;
  height:20px;
  background:rgba(255,255,255,.35);
  border-radius:50%;
}

.porcentagem{
  font-size:1.4rem;
  font-weight:700;
  color:var(--azul-escuro);
}

/* ---------- BOT√ïES ---------- */
.btn{
  border:none;
  padding:.6rem .9rem;
  border-radius:12px;
  background:var(--azul);
  color:#fff;
  cursor:pointer;
  font-weight:600;
}

.btn.claro{background:var(--azul-claro);color:var(--azul-escuro)}
.btn.perigo{background:#d64545}

.botoes{
  display:grid;
  grid-template-columns:repeat(3,1fr);
  gap:.5rem;
  margin-top:.5rem;
}

/* ---------- FORM ---------- */
input{
  width:100%;
  padding:.6rem;
  border-radius:10px;
  border:1px solid #cfdce5;
}

/* ---------- HIST√ìRICO ---------- */
.lista{
  max-height:280px;
  overflow:auto;
}

.item{
  display:flex;
  justify-content:space-between;
  align-items:center;
  padding:.5rem;
  border-bottom:1px solid #e3eef6;
}

.item small{opacity:.7}

.item button{
  border:none;
  background:none;
  cursor:pointer;
  font-size:1rem;
}

/* ---------- GR√ÅFICO ---------- */
canvas{width:100%;max-height:280px}

/* ---------- RESPONSIVO ---------- */
@media(max-width:900px){
  .container{grid-template-columns:1fr}
}
</style>
</head>

<body>

<header>üíß Controle de Hidrata√ß√£o</header>

<div class="container">

<!-- ===== COLUNA ESQUERDA ===== -->
<div class="card">
  <h3>Copo do dia</h3>

  <div class="copo-wrapper">
    <div class="copo">
      <div class="agua" id="agua"></div>
    </div>
    <div class="porcentagem" id="pct">0%</div>
    <small><span id="atual">0</span> L de <span id="meta">4</span> L</small>
  </div>

  <div class="botoes">
    <button class="btn" onclick="add(200)">+200 ml</button>
    <button class="btn" onclick="add(300)">+300 ml</button>
    <button class="btn" onclick="add(500)">+500 ml</button>
  </div>

  <hr>

  <label>Editar valor do dia (ml)</label>
  <input id="editValor" type="number" placeholder="Ex: 1800">
  <button class="btn claro" onclick="editarHoje()">Salvar edi√ß√£o</button>
</div>

<!-- ===== COLUNA DIREITA ===== -->
<div class="card">
  <h3>Hist√≥rico (edit√°vel)</h3>

  <div class="lista" id="lista"></div>

  <hr>

  <h3>√öltimos dias</h3>
  <canvas id="grafico"></canvas>
</div>

</div>

<script>
let meta = 4000
let dados = JSON.parse(localStorage.getItem("aguaDados")||"{}")

const hoje = new Date().toISOString().slice(0,10)

if(!dados[hoje]) dados[hoje]=0

function salvar(){
  localStorage.setItem("aguaDados",JSON.stringify(dados))
}

function add(ml){
  dados[hoje]+=ml
  salvar()
  render()
}

function editarHoje(){
  let v = Number(editValor.value||0)
  dados[hoje]=v
  salvar()
  render()
}

function excluir(d){
  delete dados[d]
  salvar()
  render()
}

function render(){
  let atual = dados[hoje]||0
  let pct = Math.min(100,Math.round((atual/meta)*100))

  document.getElementById("atual").innerText=(atual/1000).toFixed(1)
  document.getElementById("pct").innerText=pct+"%"
  document.getElementById("agua").style.height=pct+"%"

  let lista=document.getElementById("lista")
  lista.innerHTML=""

  Object.keys(dados).sort().reverse().forEach(d=>{
    let div=document.createElement("div")
    div.className="item"
    div.innerHTML=`
      <div>
        <strong>${d}</strong><br>
        <small>${(dados[d]/1000).toFixed(1)} L</small>
      </div>
      <button onclick="excluir('${d}')">üóëÔ∏è</button>
    `
    lista.appendChild(div)
  })

  grafico()
}

function grafico(){
  let ctx=document.getElementById("grafico").getContext("2d")
  let keys=Object.keys(dados).slice(-14)
  let vals=keys.map(k=>dados[k]/1000)

  if(window.g) window.g.destroy()

  window.g=new Chart(ctx,{
    type:"line",
    data:{
      labels:keys,
      datasets:[
        {
          label:"Consumo (L)",
          data:vals,
          borderColor:"#0b3c5d",
          backgroundColor:"rgba(31,111,163,.2)",
          tension:.4,
          fill:true
        },
        {
          label:"Meta",
          data:keys.map(()=>meta/1000),
          borderColor:"#1f6fa3",
          borderDash:[5,5]
        }
      ]
    },
    options:{
      plugins:{legend:{labels:{font:{size:14}}}},
      scales:{
        y:{ticks:{font:{size:13}}},
        x:{ticks:{font:{size:12}}}
      }
    }
  })
}

render()
</script>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

</body>
</html>
